################################################################################
# Sonar Configuration File
################################################################################

# Optional Meta Data #
Company: 
Engineer: 
Project_Name: 
Target_Devices: 
Tool_Versions: 
Description: 
Dependencies: 

# Required Data #
Module_Name: handler
Timescale: 1ns / 1ps #the default timescale of the simulation
Time_Format: {unit: "1us", precision: 3} #can be one of s, ms, us, ns, ps, fs
Flag_Count: 1

################################################################################

# DUT #
DUT:
  - {direction: input, name: ap_clk, type: clock, period: 20ns}
  - {direction: input, name: ap_rst_n, type: reset}
  - {direction: input, name: AMhandler_V, size: 4}
  - {direction: slave, name: axis_handler, type: axis, clock: ap_clk, 
  c_struct: axis_word, c_stream: uaxis_n, channels: [
    {name: "TDATA", type: "tdata", size: 64},
    {name: "TVALID", type: "tvalid"},
    {name: "TREADY", type: "tready"},
    {name: "TLAST", type: "tlast"}
  ]}
  - {direction: mixed, name: s_axi_ctrl_bus, type: s_axilite, clock: ap_clk, reset: ap_rst_n,
  registers: [counter_threshold, counter_reset], regAddrs: [0x10, 0x18], 
  address_range: 4K, address_offset: 0, connectionMode: ip, channels: [
    {name: AWVALID, type: awvalid},
    {name: AWREADY, type: awready},
    {name: AWADDR, type: awaddr, size: 12},
    {name: WVALID, type: wvalid},
    {name: WREADY, type: wready},
    {name: WDATA, type: wdata, size: 32},
    {name: WSTRB, type: wstrb, size: 4},
    {name: ARVALID, type: arvalid},
    {name: ARREADY, type: arready},
    {name: ARADDR, type: araddr, size: 12},
    {name: RVALID, type: rvalid},
    {name: RREADY, type: rready},
    {name: RDATA, type: rdata, size: 32},
    {name: RRESP, type: rresp, size: 2},
    {name: BVALID, type: bvalid},
    {name: BREADY, type: bready},
    {name: BRESP, type: bresp, size: 2}
  ]}
  - {direction: output, name: interrupt_V, size: 1}

################################################################################

Initialize: &Initialize
  - wait: {key: ap_clk}
  - macro: INIT_SIGNALS
  - delay: 40ns
  - signal:
    - {name: AMhandler_V, value: 1}
    - {name: ap_rst_n, value: 1}

Short_Message_A: &Short_Message_A
  - Parallel_Section_0: *Initialize
  - Parallel_Section_1:
    - delay: 100ns
    - timestamp: INIT
    - interface: {type: s_axilite, name: s_axi_ctrl_bus, payload: [
      {mode: 1, data: 0x4, addr: 0x10},
      {mode: 1, data: 1, addr: 0x18}
    ]}
    - interface: {type: axis, name: axis_handler, payload: [
      # {tdata: "{AMHeader,0xAA,0x2,0xC,1,0x5,2}", callTB: 1},
      {tdata: "0x5", tlast: 1, callTB: 2}
    ]}
    - wait: {key: interrupt}
    - interface: {type: s_axilite, name: s_axi_ctrl_bus, payload: [
      {mode: 1, data: 2, addr: 0x18},
      {mode: 1, data: 1, addr: 0x18}
    ]}
    - timestamp: Short_Message_A
    - macro: END
################################################################################

Wait_Conditions:
  - {condition: "@(negedge ap_clk);", key: ap_clk}
  - {condition: "wait(interrupt_V == 1);", key: interrupt}

Test_Vectors:
  - Test_Vector_0: *Short_Message_A
  