################################################################################
# Sonar Configuration File
################################################################################

# Optional Meta Data #
Company: 
Engineer: 
Project_Name: 
Target_Devices: 
Tool_Versions: 
Description: 
Dependencies: 

# Required Data #
Module_Name: handler_wrapper
Timescale: 1ns / 1ps #the default timescale of the simulation
Time_Format: {unit: "1us", precision: 3} #can be one of s, ms, us, ns, ps, fs
Flag_Count: 1

################################################################################

# DUT #
DUT:
  - {direction: input, name: clock, type: clock, period: 20ns}
  - {direction: input, name: reset_n, type: reset}
  - {direction: slave, name: axis_handler, type: axis, clock: clock, 
  c_struct: axis_word, c_stream: uaxis_n, channels: [
    {name: "tdata", type: "tdata", size: 64},
    {name: "tvalid", type: "tvalid"},
    {name: "tready", type: "tready"},
    {name: "tlast", type: "tlast"}
  ]}
  - {direction: input, name: address_offset, size: 16}
  - {direction: mixed, name: s_axi_ctrl_bus_0, type: s_axilite, clock: clock, reset: reset_n,
  registers: [counter_threshold, counter_reset], regAddrs: [0x10, 0x18], 
  address_range: 4K, address_offset: 0, connectionMode: ip, channels: [
    {name: AWVALID, type: awvalid},
    {name: AWREADY, type: awready},
    {name: AWADDR, type: awaddr, size: 12},
    {name: WVALID, type: wvalid},
    {name: WREADY, type: wready},
    {name: WDATA, type: wdata, size: 32},
    {name: WSTRB, type: wstrb, size: 4},
    {name: ARVALID, type: arvalid},
    {name: ARREADY, type: arready},
    {name: ARADDR, type: araddr, size: 12},
    {name: RVALID, type: rvalid},
    {name: RREADY, type: rready},
    {name: RDATA, type: rdata, size: 32},
    {name: RRESP, type: rresp, size: 2},
    {name: BVALID, type: bvalid},
    {name: BREADY, type: bready},
    {name: BRESP, type: bresp, size: 2}
  ]}
  - {direction: mixed, name: s_axi_ctrl_bus_1, type: s_axilite, clock: clock, reset: reset_n,
  registers: [counter_threshold, counter_reset], regAddrs: [0x10, 0x18], 
  address_range: 4K, address_offset: 0, connectionMode: ip, channels: [
    {name: AWVALID, type: awvalid},
    {name: AWREADY, type: awready},
    {name: AWADDR, type: awaddr, size: 12},
    {name: WVALID, type: wvalid},
    {name: WREADY, type: wready},
    {name: WDATA, type: wdata, size: 32},
    {name: WSTRB, type: wstrb, size: 4},
    {name: ARVALID, type: arvalid},
    {name: ARREADY, type: arready},
    {name: ARADDR, type: araddr, size: 12},
    {name: RVALID, type: rvalid},
    {name: RREADY, type: rready},
    {name: RDATA, type: rdata, size: 32},
    {name: RRESP, type: rresp, size: 2},
    {name: BVALID, type: bvalid},
    {name: BREADY, type: bready},
    {name: BRESP, type: bresp, size: 2}
  ]}
  - {direction: output, name: interrupt_0, size: 1}
  - {direction: output, name: interrupt_1, size: 1}

################################################################################

Initialize: &Initialize
  - wait: {key: clock}
  - macro: INIT_SIGNALS
  - delay: 40ns
  - signal:
    - {name: reset_n, value: 1}
    - {name: address_offset, value: 0}

Short_Message_A: &Short_Message_A
  - Parallel_Section_0: *Initialize
  - Parallel_Section_1:
    - delay: 100ns
    - timestamp: INIT
    - interface: {type: s_axilite, name: s_axi_ctrl_bus_0, payload: [
      {mode: 1, data: 0x4, addr: 0x10},
      {mode: 1, data: 1, addr: 0x18}
    ]}
    - interface: {type: s_axilite, name: s_axi_ctrl_bus_1, payload: [
      {mode: 1, data: 0x4, addr: 0x10},
      {mode: 1, data: 1, addr: 0x18}
    ]}
    - interface: {type: axis, name: axis_handler, payload: [
      {tdata: "{AMHeader,0xAA,0x1,0xC,1,0x5,2}", callTB: 1},
      {tdata: "0x5", tlast: 1, callTB: 2}
    ]}
    - interface: {type: axis, name: axis_handler, payload: [
      {tdata: "{AMHeader,0xAA,0x0,0xC,1,0x5,2}", callTB: 1},
      {tdata: "0x5", tlast: 1, callTB: 2}
    ]}
  - Parallel_Section_2:
    - wait: {key: interrupt}
    - interface: {type: s_axilite, name: s_axi_ctrl_bus_0, payload: [
      {mode: 1, data: 2, addr: 0x18},
      {mode: 1, data: 1, addr: 0x18}
    ]}
  - Parallel_Section_3:
    - wait: {key: interrupt}
    - interface: {type: s_axilite, name: s_axi_ctrl_bus_1, payload: [
      {mode: 1, data: 2, addr: 0x18},
      {mode: 1, data: 1, addr: 0x18}
    ]}
    - timestamp: Short_Message_A
    - macro: END
################################################################################

Wait_Conditions:
  - {condition: "@(negedge clock);", key: clock}
  - {condition: "wait(interrupt_0 == 1);", key: interrupt}

Test_Vectors:
  - Test_Vector_0: *Short_Message_A
  